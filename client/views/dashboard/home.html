<template name="dashboard_widget">
  <div class="widget-panel {{klass}}">
    <header class="heading">{{>yield region="dashboard-header"}}</header>
    <div class="content">
      {{!kick the extra content}}
      {{>yield}}
      {{>yield region="dashboard-content"}}
    </div>
  </div>
</template>

<template name="dashboard_card">
  <div class="card-panel">
    <div class="content">
      <div class="row">
          <div class="number col-sm-8">{{number}} <span class="unit">{{unit}}</span></div>
          <div class="diff col-sm-4">
            {{! change the context into the result object of setSign }}
            {{#with setSign diff}}
            <span class="sign {{klass}}"></span>
            <span class="value">{{value}} {{unit}}</span>
            {{/with}}
          </div>
      </div>
      <div class="row">
        <div class="field heading col-sm-8">{{field}}</div>
        <div class="duration col-sm-4">{{duration}}</div>
      </div>
    </div>
  </div>
</template>

<!-- Specific Template -->
<template name="dashboard_performance_chart">
  {{#Layout template="dashboard_widget" klass="dashboard-performance"}}

    {{#contentFor region="dashboard-header"}}
      <h4 class="headline">Performance</h4>
      <div class="widget-nav pull-right performance-nav">
        <ul class="">
          <li><a href="#" data-session-target="view-building"><i class="fa fa-building-o"></i></a></li>
          <li class="active"><a href="#" data-session-target="view-chart"><i class="fa fa-line-chart"></i></a></li>
          <li><a href="#" data-session-target="view-grid"><span class="glyphicon glyphicon-th-large"></span></a></li>
        </ul>
      </div>
    {{/contentFor}}

    {{#contentFor region="dashboard-content"}}
      <div class="chart-wrapper">
        {{! context : this.data = performances }}
        {{#if showChart}}
          {{> dashboard_performance_charting}}
        {{/if}}

        {{#if showGrid}}
          {{> dashboard_performance_matrix}}
        {{/if}}

        {{#if showFloor}}
          {{> dashboard_performance_floor}}
        {{/if}}
      </div>
    {{/contentFor}}
  {{/Layout}}
</template>

<template name="dashboard_performance_charting">
  <div class="performance charting"></div>
</template>

<template name="dashboard_performance_matrix">
  <div class="performance matrix">
    Coming Soon...
  </div>
</template>

<template name="dashboard_performance_floor">
  <div class="performance floor">
    Floor map
  </div>
</template>

<template name="dashboard_campaign_list">
  <div class="campaign-list widget-panel">
    <table class="table">
      <thead class="heading">
        <tr class="row" >
          <th class="col-sm-7">Campaign</th>
          <th class="col-sm-2">Sent</th>
          <th class="col-sm-2">Visited</th>
          <th class="col-sm-1">Conversion</th>
        </tr>
      </thead>

      <tbody class="content">
      {{#each campaigns}}
        {{#with _id=_id name=name sent=sent visited=visited conversion=conversion desc=desc stat=getStat m=getMetrics traceOffset=traceOffset}}
        <tr class="row campaign-summary data-row" data-id="{{_id}}">
          <td class="name entity col-sm-7">{{name}}</td>
          <td class="sent value col-sm-2">{{sent}}</td>
          <td class="visited value col-sm-2">{{visited}}</td>
          <td class="conversion value col-sm-1">{{percentage conversion}}</td>
        </tr>
        <tr class="row campaign-summary chart-row" data-id="{{_id}}">
          <td class="chart-area" colspan="4">
            <div class="row">
              <div class="desc value col-sm-6">{{desc}}</div>
            </div>
            <div class="row">
              <div class="desc value col-sm-5">
                <div class="campaign-summary-chart">
                  <div class="charting-area"></div>
                </div>
              </div>
              <div class="desc value col-sm-7">
                {{! compare with locationMetric t1 t2 }}
                {{!with locationMetrics startTime offset}}
                  {{! Change`data-entity` if helper changes }}
                  <div class="campaign-comparsion-chart">
                    <div class="charting-area total-visits col-xs-4" data-entity="totalVisits"></div>
                    <div class="charting-area dwell-time col-xs-4" data-entity="avgDwellTime"></div>
                    <div class="charting-area repeated-visits col-xs-4" data-entity="repeatedVisits"></div>
                  </div>
                {{!with}}
              </div>
            </div>
          </td>
        </tr>
        {{/with}}
      {{/each}}
      </tbody>
    </table>
  </div>
</template>


<template name="dashboard_home">
  <div class="dashboard">
  {{#with locationMetric}}
    <div class="summary highlights row">
      <div class="col-sm-4">
        {{> dashboard_card totalVisits }}
      </div>
      <div class="col-sm-4">
        {{> dashboard_card avgDwellTime}}
      </div>
      <div class="col-sm-4">
        {{> dashboard_card repeatedVisits}}
      </div>
    </div>
  {{/with}}
  {{#with performances }}
    {{> dashboard_performance_chart }}
  {{/with}}
  {{> dashboard_campaign_list campaigns=campaigns }}
  </div>
</template>




